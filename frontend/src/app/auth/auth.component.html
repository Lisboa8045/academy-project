<div class="auth-container">
  <h2>{{ isLoginMode() ? 'Login' : 'Sign Up' }}</h2>

  <form [formGroup]="authForm" (ngSubmit)="submit()">

    @if (isLoginMode()){
      <input type="text" formControlName="login" placeholder="Email or Username" required maxlength="255" />
      <div class="validation-error" *ngIf="authForm.get('login')?.errors?.['required'] && authForm.get('login')?.touched">
        Email/Username is required.
      </div>
      <div class="validation-error" *ngIf="authForm.get('login')?.errors?.['maxlength'] && authForm.get('login')?.touched">
        Please insert 254 characters or less.
      </div>
    } @else {
      <input type="email" formControlName="email" placeholder="Email" required/>
      <div class="validation-error" *ngIf="authForm.get('email')?.errors?.['required'] && authForm.get('email')?.touched">
        Email is required.
      </div>
      <div class="validation-error" *ngIf="authForm.get('email')?.errors?.['email'] && authForm.get('email')?.touched">
        Enter a valid email.
      </div>
      <div class="validation-error" *ngIf="authForm.get('email')?.errors?.['maxlength'] && authForm.get('email')?.touched">
        Email must be at most 254 characters.
      </div>

      <input type="text" formControlName="username" placeholder="Username" required/>
      <div class="validation-error" *ngIf="authForm.get('username')?.errors?.['required'] && authForm.get('username')?.touched">
        Username is required.
      </div>
      <div class="validation-error" *ngIf="(authForm.get('username')?.errors?.['minlength'] || authForm.get('username')?.errors?.['maxlength']) && authForm.get('username')?.touched">
        Username must be between 4 and 20 characters.
      </div>
      <div class="validation-error" *ngIf="authForm.get('username')?.errors?.['specialCharsNotAllowed'] && authForm.get('username')?.touched">
        Special characters are not allowed in the username.
      </div>
    }

    @if (isLoginMode()){
      <input type="password" formControlName="password" placeholder="Password" required maxlength="65" />
      <div class="validation-error" *ngIf="authForm.get('password')?.errors?.['maxlength'] && authForm.get('password')?.touched">
        Please insert 64 characters or less.
      </div>
    }
    @else {
      <input type="password" formControlName="password" placeholder="Password" required />
      <div class="validation-error" *ngIf="authForm.get('password')?.errors?.['weakPassword'] && authForm.get('password')?.touched">
        Password must include uppercase, lowercase, digit, and special character.
      </div>
      <div class="validation-error" *ngIf="(authForm.get('password')?.errors?.['minlength'] || authForm.get('password')?.errors?.['maxlength']) && authForm.get('password')?.touched">
        Password must be between 8 and 64 characters.
      </div>
    }
    <div class="validation-error" *ngIf="authForm.get('password')?.errors?.['required'] && authForm.get('password')?.touched">
      Password is required.
    </div>


    @if (!isLoginMode()){

      <input type="password" formControlName="confirmPassword" placeholder="Confirm Password" [class.ng-invalid]="authForm.hasError('passwordsMismatch') && authForm.get('confirmPassword')?.touched" required />
      <div class="validation-error" *ngIf="authForm.hasError('passwordsMismatch') && authForm.get('confirmPassword')?.touched">
        Passwords do not match.
      </div>
    }

    <button type="submit" [disabled]="authForm.invalid">
      {{ isLoginMode() ? 'Login' : 'Create Account' }}
    </button>
  </form>

  <p>
    {{ isLoginMode() ? "Don't have an account?" : 'Already have an account?' }}
    <button type="button" (click)="toggleMode() ">
      {{ isLoginMode() ? 'Sign up' : 'Login' }}
    </button>
  </p>
</div>
